EditText amountEditText = findViewById(R.id.editTextAmount);

amountEditText.addTextChangedListener(new TextWatcher() {
    private String lastValid = "";

    @Override
    public void beforeTextChanged(CharSequence s, int start, int count, int after) { }

    @Override
    public void onTextChanged(CharSequence s, int start, int before, int count) { }

    @Override
    public void afterTextChanged(Editable s) {
        String input = s.toString();

        if (input.isEmpty()) return;

        // Prevent multiple leading zeros like 0000, 0123
        if (input.matches("^0\\d+")) {
            amountEditText.removeTextChangedListener(this);
            amountEditText.setText("0");
            amountEditText.setSelection(1);
            amountEditText.addTextChangedListener(this);
            Toast.makeText(getApplicationContext(), "Leading zeros are not allowed", Toast.LENGTH_SHORT).show();
            return;
        }

        try {
            double value = Double.parseDouble(input);

            // Restrict max value to 5000.00
            if (value > 5000.00) {
                amountEditText.removeTextChangedListener(this);
                amountEditText.setText(lastValid);
                amountEditText.setSelection(lastValid.length());
                amountEditText.addTextChangedListener(this);
                Toast.makeText(getApplicationContext(), "Amount cannot exceed 5000", Toast.LENGTH_SHORT).show();
            } else {
                lastValid = input;  // Store valid input
            }

        } catch (NumberFormatException e) {
            amountEditText.setError("Invalid input");
        }
    }
});
